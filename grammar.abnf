;; Haga Configuration Language ABNF Specification
;;
;; Haga requires strict cardinality for all declarations.
;; Core ABNF Rules (RFC 5234) are assumed (ALPHA, DIGIT, SP).

;; -- Foundations --
manifest      = *statement
;; Content is optional to support empty lines and comments.
statement     = *space [ scope / declaration ] *space [comment] newline

;; --- Scoping ---
scope         = "scope" 1*space identifier 1*space block
declaration   = cardinality 1*space noun [ 1*space argument-list ]
block         = "{" newline *statement "}"

;; --- Keywords ---
cardinality   = "must" / "may" / "any" / "some"
noun          = identifier
argument-list = value *( "," space value )
identifier    = (ALPHA / "_" / UTF8-byte) *(ALPHA / DIGIT / "_" / UTF8-byte)

;; --- Values ---
value         = string / boolean / decimal / integer
boolean       = "true" / "false"
;; Integers are signed, arbitrary precision, and may be in base-10 or base-16.
integer       = decimal-int / hex-int
;; Reuse decimal-int to enforce sign and leading-zero rules on the integer part.
decimal       = decimal-int "." 1*DIGIT
decimal-int   = ["-"] ( "0" / non-zero-digit *DIGIT )
;; Hex: 0x prefix, standard hex digits, negative hex literals supported.
hex-int       = ["-"] "0x" 1*HEXDIGIT
non-zero-digit = %x31-39 ; 1-9
;; Double-quotes only, single-quotes are content, not delimiter:
string        = quotation-mark *char quotation-mark

;; --- Lexical Tokens ---
comment       = "#" *printable
space         = SP
newline       = LF
quotation-mark = %x22  ; "
char          = unescaped / escaped
unescaped     = %x20-21 / %x23-5B / %x5D-7E / UTF8-byte ; Printable ASCII excluding " and \
escaped       = "\" ( "n" / "r" / "t" / "\" / quotation-mark )
printable     = %x20-7E / UTF8-byte ; Printable ASCII characters plus UTF-8
UTF8-byte     = %x80-FF
HEXDIGIT      = DIGIT / "A" / "B" / "C" / "D" / "E" / "F"
